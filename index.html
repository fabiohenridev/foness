<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fones de Ouvido Gamer Pro - Som Imersivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #1a1a1a;
            color: #ffffff;
        }
        .btn-red {
            background-color: #e63946;
            transform: translateY(0);
            transition: transform 0.2s ease, background-color 0.3s ease;
        }
        .btn-red:hover {
            background-color: #d00000;
            transform: translateY(-2px);
        }
        .section-title {
            position: relative;
            display: inline-block;
            margin-bottom: 1.5rem;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 3px;
            background-color: #e63946;
        }
        img {
            transition: transform 0.3s ease;
        }
        img:hover {
            transform: scale(1.05);
        }
        .comment-card {
            transition: transform 0.2s ease;
        }
        .comment-card:hover {
            transform: translateY(-4px);
        }
    </style>
    <link rel="icon" href="fone-venda.webp" type="image/x-icon">
</head>
<body class="font-sans">
    <!-- Cabeçalho -->
    <header class="bg-black text-white py-6">
        <div class="container mx-auto text-center">
            <h1 class="text-4xl md:text-5xl font-bold">Fones de Ouvido Gamer Pro</h1>
            <p class="mt-3 text-lg md:text-xl text-gray-300">Domine o jogo com som imersivo e conforto imbatível!</p>
        </div>
    </header>

    <!-- Seção do Produto -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2">
                    <img src="fone-venda.webp" alt="Fones de Ouvido" class="rounded-lg shadow-lg w-full" onerror="this.src='fallback-image.jpg'">
                </div>
                <div class="md:w-1/2 mt-8 md:mt-0 md:pl-10">
                    <h2 class="text-3xl md:text-4xl font-bold text-white section-title">Eleve Sua Experiência de Jogo ao Máximo</h2>
                    <p class="mt-4 text-gray-300 leading-relaxed">
                        Os <strong>Fones de Ouvido Gamer Pro</strong> são sua arma secreta para vencer qualquer batalha. Com som estéreo 7.1, você ouve cada passo do inimigo e sente a emoção de cada explosão. Não é apenas um fone de ouvido — é a diferença entre jogar e dominar.
                    </p>
                    <ul class="mt-6 space-y-3 text-gray-300">
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-red-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                            <strong>Som Estéreo 7.1 Imersivo:</strong> Identifique a direção dos inimigos com precisão.
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-red-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                            <strong>Redução de Ruído Tripla:</strong> Microfone destacável com som cristalino, sem interferências.
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-red-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                            <strong>Conforto Sem Igual:</strong> Design intra-auricular com silicone que não cai, mesmo em longas sessões.
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-red-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                            <strong>Plugue em L:</strong> Jogue sem obstáculos, com liberdade total de movimento.
                        </li>
                    </ul>
                </div>
            </div>
            <!-- Especificações Técnicas -->
            <div class="mt-12 bg-gray-900 p-8 rounded-lg">
                <h3 class="text-2xl md:text-3xl font-bold text-white section-title">Especificações Técnicas</h3>
                <ul class="mt-6 text-gray-300 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <li><strong>Faixa de Resposta de Frequência:</strong> 20-20000 Hz</li>
                    <li><strong>Impedância:</strong> 16 Ω</li>
                    <li><strong>Sensibilidade:</strong> 109 dB</li>
                    <li><strong>Taxa de Distorção:</strong> 1%</li>
                    <li><strong>Comprimento do Cabo:</strong> 1,2 m</li>
                    <li><strong>Diâmetro do Alto-falante:</strong> 10 mm</li>
                    <li><strong>Material dos Tampões:</strong> ABS</li>
                    <li><strong>Material do Cabo:</strong> TPE</li>
                    <li><strong>Tipo:</strong> Fones Intra-auriculares</li>
                    <li><strong>Plugue:</strong> 3,5 mm, L-Bend</li>
                    <li><strong>Microfone:</strong> Sim, destacável</li>
                    <li><strong>Inclui:</strong> 1 Fone de Ouvido, 1 Manual</li>
                </ul>
            </div>
            <p class="mt-6 text-lg text-red-500 font-bold">Por apenas R$59,99, transforme sua experiência de jogo HOJE!</p>
            <!-- Botão Comprar Agora -->
            <div class="mt-8 text-center">
                <button id="buyNow" class="btn-red text-white px-8 py-4 rounded-lg text-lg font-semibold shadow-lg" aria-label="Comprar Agora">Comprar Agora!</button>
            </div>
        </div>
    </section>

    <!-- Seção de Depoimentos -->
    <section class="bg-gray-900 py-16">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center text-white section-title">O que os Gamers Estão Dizendo</h2>
            <div class="mt-10 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-black p-6 rounded-lg shadow-lg">
                    <p class="text-gray-300">"O som é tão claro que ouvi o inimigo antes de vê-lo! Esses fones mudaram meu jogo."</p>
                    <p class="mt-4 font-bold text-white">- João Silva</p>
                </div>
                <div class="bg-black p-6 rounded-lg shadow-lg">
                    <p class="text-gray-300">"Confortáveis por horas e o microfone é perfeito para estratégias em equipe."</p>
                    <p class="mt-4 font-bold text-white">- Maria Oliveira</p>
                </div>
                <div class="bg-black p-6 rounded-lg shadow-lg">
                    <p class="text-gray-300">"Melhor custo-benefício que já vi. Não jogo mais sem eles!"</p>
                    <p class="mt-4 font-bold text-white">- Pedro Santos</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Seção de Comentários -->
    <section class="py-16 bg-gray-900">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center text-white section-title">Deixe Seu Comentário</h2>
            <p class="mt-3 text-center text-gray-300">Compartilhe sua experiência com os Fones de Ouvido Gamer Pro!</p>
            <div class="mt-10 max-w-md mx-auto">
                <div class="space-y-4">
                    <label for="commentName" class="sr-only">Seu Nome</label>
                    <input type="text" id="commentName" placeholder="Seu Nome" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-white">
                    <label for="commentEmail" class="sr-only">Seu Email</label>
                    <input type="email" id="commentEmail" placeholder="Seu Email" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-white">
                    <label for="commentMessage" class="sr-only">Seu Comentário</label>
                    <textarea id="commentMessage" placeholder="Seu Comentário" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-white" rows="4"></textarea>
                    <button id="submitComment" class="w-full btn-red text-white px-6 py-3 rounded-lg text-lg font-semibold" aria-label="Enviar Comentário">Enviar Comentário</button>
                </div>
            </div>
            <div id="commentsList" class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>
    </section>

    <!-- Rodapé -->
    <footer class="bg-black text-white py-6">
        <div class="container mx-auto text-center">
            <p>© 2025 Fones de Ouvido Gamer Pro. Todos os direitos reservados.</p>
            <p class="mt-2 text-sm text-gray-300">Envio em até 24h em dias úteis | Suporte dedicado</p>
        </div>
    </footer>

    <!-- Socket.IO Client -->
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
    <script>
        const API_BASE_URL = 'https://backend-fone.onrender.com';
        const socket = io(API_BASE_URL);

        // Função para escapar HTML e prevenir XSS
        function escapeHTML(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // Função para o botão Comprar Agora
        document.getElementById('buyNow').addEventListener('click', () => {
            alert('Redirecionando para a página de pagamento...');
            // Aqui você pode adicionar o redirecionamento para o checkout
        });

        // Função para adicionar um novo comentário ao DOM
        function addCommentToDOM(comment) {
            const commentsList = document.getElementById('commentsList');
            const noComments = commentsList.querySelector('p.text-gray-300.text-center');
            if (noComments) {
                commentsList.innerHTML = '';
            }
            const commentCard = document.createElement('div');
            commentCard.className = 'bg-black p-6 rounded-lg shadow-lg comment-card';
            commentCard.innerHTML = `
                <p class="text-gray-300">${escapeHTML(comment.message)}</p>
                <p class="mt-4 font-bold text-white">- ${escapeHTML(comment.name)}</p>
                <p class="text-sm text-gray-500">${new Date(comment.createdAt).toLocaleDateString('pt-BR')}</p>
            `;
            commentsList.insertBefore(commentCard, commentsList.firstChild); // Adiciona no topo
        }

        // Função para carregar comentários iniciais
        async function loadComments() {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '<p class="text-gray-300 text-center">Carregando comentários...</p>';

            try {
                const response = await fetch(`${API_BASE_URL}/api/comments`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                    },
                });

                if (!response.ok) {
                    throw new Error(`Erro HTTP: ${response.status}`);
                }

                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    throw new Error('Resposta não é JSON');
                }

                const comments = await response.json();
                commentsList.innerHTML = '';

                if (comments.length === 0) {
                    commentsList.innerHTML = '<p class="text-gray-300 text-center">Nenhum comentário ainda. Seja o primeiro!</p>';
                    return;
                }

                comments.forEach(comment => addCommentToDOM(comment));
            } catch (error) {
                console.error('Erro ao carregar comentários:', error);
                commentsList.innerHTML = '<p class="text-red-500 text-center">Erro ao carregar comentários. Verifique se o servidor está ativo ou tente novamente mais tarde.</p>';
            }
        }

        // Função para enviar comentário
        document.getElementById('submitComment').addEventListener('click', async () => {
            const name = document.getElementById('commentName').value.trim();
            const email = document.getElementById('commentEmail').value.trim();
            const message = document.getElementById('commentMessage').value.trim();

            if (!name || !email || !message) {
                alert('Por favor, preencha todos os campos (nome, email e comentário).');
                return;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Por favor, insira um email válido.');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/api/comments`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    },
                    body: JSON.stringify({ name, email, message }),
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Erro HTTP: ${response.status}`);
                }

                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    throw new Error('Resposta não é JSON');
                }

                const result = await response.json();
                alert(result.message);
                document.getElementById('commentName').value = '';
                document.getElementById('commentEmail').value = '';
                document.getElementById('commentMessage').value = '';
                // O comentário será adicionado via Socket.IO, não precisa recarregar
            } catch (error) {
                console.error('Erro ao enviar comentário:', error);
                if (error.message.includes('Erro de validação')) {
                    alert('Erro de validação. Verifique os campos e tente novamente.');
                } else {
                    alert(`Erro ao enviar o comentário: ${error.message}. Verifique se o servidor está ativo ou tente novamente mais tarde.`);
                }
            }
        });

        // Socket.IO: Escutar novos comentários em tempo real
        socket.on('newComment', (comment) => {
            addCommentToDOM(comment);
        });

        // Socket.IO: Manipular conexão
        socket.on('connect', () => {
            console.log('Conectado ao servidor WebSocket');
        });

        socket.on('disconnect', () => {
            console.log('Desconectado do servidor WebSocket');
        });

        // Carregar comentários ao iniciar a página
        loadComments();
    </script>
</body>
</html>